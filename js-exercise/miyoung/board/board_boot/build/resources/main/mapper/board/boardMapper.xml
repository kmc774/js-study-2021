<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mi.board.model.repository.BoardRepository">
    
    <select id="selectBoardCnt" resultType="integer">
        SELECT COUNT(*)
          FROM BOARD
    </select>


    <insert id="insertBoard" parameterType="Board" >
        INSERT INTO BOARD
                 (
                    TITLE
                  , CONTENT
                  , USER_ID
                  , REG_DT
                 )
        VALUES (
                  #{title}
                , #{content}
                , #{userId}
                , NOW()
               )
    </insert>


    <select id="selectBoardList" parameterType="com.mi.util.paging.Paging" resultType="Board">
       SELECT  A.BD_IDX
              , A.TITLE
              , A.CONTENT
              , A.USER_ID
              , A.REG_DT
              , A.CRTN_DT
        FROM  (
                SELECT *
                FROM BOARD
                ORDER BY BD_IDX DESC
              ) A
       LIMIT ${queryStart} , ${cntPerPage};

    </select>

    <select id="selectSearchBoardCnt" resultType="integer">
        SELECT  COUNT(*)
         FROM   BOARD
        <choose>
            <when test="type == 'all'">
                WHERE TITLE  LIKE CONCAT('%', #{keyword}, '%')
                  OR CONTENT LIKE CONCAT('%', #{keyword}, '%')
                  OR USER_ID LIKE CONCAT('%', #{keyword}, '%')
            </when>
            <when test="type == 'title'">
               WHERE TITLE   LIKE CONCAT('%', #{keyword}, '%')
            </when>
            <when test="type == 'content'">
               WHERE CONTENT LIKE CONCAT('%', #{keyword}, '%')
            </when>
            <when test="type == 'userId'">
               WHERE USER_ID LIKE CONCAT('%', #{keyword}, '%')
            </when>
        </choose>
    </select>



    <select id="selectBoardDetail" parameterType="Integer" resultType="Board">
        SELECT BD_IDX , TITLE, CONTENT, USER_ID
          FROM BOARD
         WHERE BD_IDX = #{bdIdx};
    </select>




    <select id="selectSearchList" parameterType = "java.lang.String" resultType="Board">
            SELECT  BD_IDX
                  , TITLE
                  , CONTENT
                  , USER_ID
                  , REG_DT
                  , CRTN_DT
              FROM BOARD
      <choose>
          <when test="type == 'all'">
              WHERE TITLE   LIKE CONCAT('%', #{keyword}, '%')
                 OR CONTENT LIKE CONCAT('%', #{keyword}, '%')
                 OR USER_ID LIKE CONCAT('%', #{keyword}, '%')
          </when>
          <when test="type == 'title'">
              WHERE TITLE   LIKE CONCAT('%', #{keyword}, '%')
          </when>
          <when test="type == 'content'">
              WHERE CONTENT LIKE CONCAT('%', #{keyword}, '%')
          </when>
          <when test="type == 'userId'">
              WHERE USER_ID LIKE CONCAT('%', #{keyword}, '%')
          </when>
      </choose>
             ORDER BY BD_IDX DESC
    </select>






</mapper>