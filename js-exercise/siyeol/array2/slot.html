<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <!-- 
          0   1   2   3   4   5   6   7   8
  /(row)  0   0   0   1   1   1   2   2   2
  %(col)  0   1   2   0   1   2   0   1   2 
  -->
    <script>
      //슬롯 클래스
      class Slot {
        constructor( inputAmount ) {
          this._amount = inputAmount
          this._matrix = Array.from(Array(3), () => new Array(3))
          this._shapeList = [
            { shape: "star", score: 10 },
            { shape: "square", score: 5 },
            { shape: "circle", score: 3 },
            { shape: "triangle", score: 2 },
          ]
        }

        start() {
          let rows = 0
          let columns = 0
          for (let count = 0; count < Math.pow(this._matrix.length, 2); count++) {
            this._matrix[columns][rows] = this._shapeList[parseInt(Math.random() * 4)]
            rows++
            if ((count + 1) % 3 === 0) {
              columns++
              rows = 0
            }
          }
        } // start()

        winCheck() {
          const resultList = []
          this._matrix.forEach(function (item, idx) {
            let set_check = new Set()
            const result = {}
            item.map((v) => set_check.add(v))
            if (set_check.size === 1) {
              result.idx = idx
              result.shapeInfo = item[0]
              resultList.push(result)
            }
          })
          return resultList
        }

        output( winCheck, inputAmount ){
          const winIdx = []
          let winAmount = 0
          const winList = winCheck
          if( winList.length > 0){
            winList.forEach( function(item, idx){
              winAmount += item.shapeInfo.score * inputAmount
              winIdx.push(item.idx)
            })
            console.log('win')
            console.log(winIdx)
            return winAmount + " coin return"
          }else{
            console.log('fail')
            return "fail"
          }
          
        }

      } // 클래스
      
      const slot = new Slot(3)
      slot.start()
      console.log(slot.output(slot.winCheck(), slot._amount))
    </script>
  </body>
</html>

<!-- 테스트용 데이터 
slot._matrix[0][0] = slot._shapeList[0];
slot._matrix[0][1] = slot._shapeList[0];
slot._matrix[0][2] = slot._shapeList[0];

slot._matrix[1][0] = slot._shapeList[1];
slot._matrix[1][1] = slot._shapeList[1];
slot._matrix[1][2] = slot._shapeList[1];

slot._matrix[2][0] = slot._shapeList[2];
slot._matrix[2][1] = slot._shapeList[2];
slot._matrix[2][2] = slot._shapeList[2]; 
-->
